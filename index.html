<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ambient Concept Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Cutive+Mono&family=Cormorant+Garamond:ital,wght@0,300;1,300&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #080807;
    --border: #1e1e1c;
    --border-mid: #2e2e2a;
    --dim: #383830;
    --mid: #686858;
    --text: #b8b898;
    --bright: #e0e0c0;

    --mood-dark:    #ab7a7a;
    --mood-light:   #7aab8a;
    --set-space:      #8a7aab;
    --set-nature:     #7aab8a;
    --set-city:       #7a9bab;
    --set-industrial: #ab9e7a;
    --set-archive:    #9bab7a;
    --set-fantasy:    #ab8a7a;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Cutive Mono', monospace;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 48px 24px;
  }

  body::after {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    opacity: 0.022;
    pointer-events: none;
    z-index: 999;
  }

  .wrap {
    width: 100%;
    max-width: 620px;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
  }

  .eyebrow {
    font-size: 9px;
    letter-spacing: 5px;
    color: var(--dim);
    text-transform: uppercase;
    margin-bottom: 48px;
  }

  /* Concept */
  .concept-wrap {
    min-height: 140px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 48px;
    width: 100%;
  }

  .concept-text {
    font-family: 'Cormorant Garamond', serif;
    font-weight: 300;
    font-style: italic;
    font-size: clamp(42px, 10vw, 72px);
    color: var(--bright);
    line-height: 1.1;
    letter-spacing: -1px;
    opacity: 0;
    transform: translateY(8px);
    transition: opacity 0.5s ease, transform 0.5s ease;
    word-break: break-word;
    display: none;
  }

  .concept-text.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .empty-state {
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
    font-weight: 300;
    font-size: 22px;
    color: var(--dim);
  }

  /* Controls */
  .controls {
    width: 100%;
    margin-bottom: 36px;
    display: flex;
    flex-direction: column;
    gap: 14px;
  }

  .control-row {
    display: flex;
    align-items: center;
    gap: 10px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .row-label {
    font-size: 9px;
    letter-spacing: 3px;
    color: var(--dim);
    text-transform: uppercase;
    width: 52px;
    text-align: right;
    flex-shrink: 0;
  }

  .selector-btn {
    background: transparent;
    border: 1px solid var(--border-mid);
    color: var(--mid);
    font-family: 'Cutive Mono', monospace;
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 8px 16px;
    cursor: pointer;
    transition: all 0.12s ease;
  }

  .selector-btn:hover {
    color: var(--text);
    border-color: var(--border-mid);
    filter: brightness(1.4);
  }

  /* Active states per type */
  .selector-btn.active[data-val="dark"]       { border-color: var(--mood-dark);       color: var(--mood-dark); }
  .selector-btn.active[data-val="light"]      { border-color: var(--mood-light);      color: var(--mood-light); }
  .selector-btn.active[data-val="space"]      { border-color: var(--set-space);       color: var(--set-space); }
  .selector-btn.active[data-val="nature"]     { border-color: var(--set-nature);      color: var(--set-nature); }
  .selector-btn.active[data-val="city"]       { border-color: var(--set-city);        color: var(--set-city); }
  .selector-btn.active[data-val="industrial"] { border-color: var(--set-industrial);  color: var(--set-industrial); }
  .selector-btn.active[data-val="archive"]    { border-color: var(--set-archive);     color: var(--set-archive); }
  .selector-btn.active[data-val="fantasy"]    { border-color: var(--set-fantasy);     color: var(--set-fantasy); }

  /* Generate */
  .generate-btn {
    background: transparent;
    border: 1px solid var(--border-mid);
    color: var(--mid);
    font-family: 'Cutive Mono', monospace;
    font-size: 11px;
    letter-spacing: 5px;
    text-transform: uppercase;
    padding: 16px 48px;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-bottom: 52px;
  }

  .generate-btn:hover {
    border-color: var(--bright);
    color: var(--bright);
  }

  .generate-btn:active { transform: scale(0.97); }

  /* History */
  .history {
    width: 100%;
    border-top: 1px solid var(--border);
    padding-top: 24px;
    display: none;
  }

  .history-label {
    font-size: 9px;
    letter-spacing: 4px;
    color: var(--dim);
    text-transform: uppercase;
    margin-bottom: 14px;
  }

  .history-items {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    justify-content: center;
    align-items: center;
  }

  .history-chip {
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
    font-size: 15px;
    color: var(--mid);
    cursor: pointer;
    transition: color 0.12s;
    padding: 2px 6px;
  }

  .history-chip:hover { color: var(--text); }
  .history-sep { color: var(--dim); font-size: 11px; }
</style>
</head>
<body>
<div class="wrap">

  <div class="eyebrow">Soap Box Rocket // Concept Engine</div>

  <div class="concept-wrap">
    <div class="empty-state" id="empty"></div>
    <div class="concept-text" id="concept-text"></div>
  </div>

  <div class="controls">
    <div class="control-row">
      <div class="row-label">Setting</div>
      <button class="selector-btn" data-group="setting" data-val="space"      onclick="toggle(this)">Space</button>
      <button class="selector-btn" data-group="setting" data-val="nature"     onclick="toggle(this)">Nature</button>
      <button class="selector-btn" data-group="setting" data-val="city"       onclick="toggle(this)">City</button>
      <button class="selector-btn" data-group="setting" data-val="industrial" onclick="toggle(this)">Industrial</button>
      <button class="selector-btn" data-group="setting" data-val="archive"    onclick="toggle(this)">Archive</button>
      <button class="selector-btn" data-group="setting" data-val="fantasy"    onclick="toggle(this)">Fantasy</button>
    </div>
    <div class="control-row">
      <div class="row-label">Mood</div>
      <button class="selector-btn" data-group="mood" data-val="dark"    onclick="toggle(this)">Dark</button>
      <button class="selector-btn" data-group="mood" data-val="light"   onclick="toggle(this)">Light</button>
    </div>
  </div>

  <button class="generate-btn" onclick="generate()">Generate</button>

  <div class="history" id="history">
    <div class="history-label">// Previous</div>
    <div class="history-items" id="history-items"></div>
  </div>

</div>

<script>
// Word pools — modifiers and nouns per mood, setting, and combos
const modifiers = {
  dark:       ['Hollow','Buried','Fractured','Broken','Decaying','Frozen','Silent','Last','Forgotten','Collapsed','Irradiated','Redacted','Locked','Incomplete','Threatening'],
  light:      ['Drifting','Distant','Borrowed','Slow','Pale','Overgrown','Flooded','Weathered','Lost','Soft','Open','Fading'],
  space:      ['Collapsed','Irradiated','Ancient','Uncharted','Orbital','Remnant','Expelled'],
  nature:     ['Overgrown','Flooded','Weathered','Slow','Rooted','Submerged','Seasonal'],
  city:       ['Compressed','Interrupted','Degraded','Looping','Wired','Concrete','Overnight'],
  industrial: ['Corroded','Pressurized','Mechanical','Grinding','Dormant','Decommissioned','Leaking'],
  archive:    ['Classified','Encrypted','Redacted','Deteriorating','Forgotten','Preserved','Incomplete'],
  fantasy:    ['Unnamed','Redacted','Lost','Incomplete','Forgotten','Buried','Uncharted'],
  neutral:    ['Lonely','Frozen','Decaying','Distant','Hollow','Buried','Drifting','Silent','Fractured','Borrowed','Forgotten','Slow','Pale','Broken','Last']
};

const nouns = {
  dark:       ['Void','Ruin','Cipher','Threshold','Static','Chamber','Debris','Hollow','Remnant','Crater'],
  light:      ['Shoreline','Horizon','Crossing','Echo','Passage','Dust','Ferry','Orbit','Bloom','Current'],
  space:      ['Planet','Crater','Void','Debris','Orbit','Dust','Transmission','Horizon','Remnant','Signal'],
  nature:     ['Shoreline','Crossing','Current','Bloom','Canopy','Estuary','Ridge','Hollow','Sediment','Shore'],
  city:       ['Corridor','Station','Archive','Broadcast','Frequency','Pulse','Tower','Overpass','Terminal','Grid'],
  industrial: ['Turbine','Pipeline','Compressor','Furnace','Silo','Substation','Foundry','Valve','Chamber','Generator'],
  archive:    ['Dispatch','Chronicle','Relic','Operator','Tape','Record','Cipher','Dossier','Transmission','Broadcast'],
  fantasy:    ['Cartographer','Cipher','Keeper','Dispatch','Expedition','Relic','Passage','Chronicle','Operator','Witness'],
  neutral:    ['Ferry','Archive','Corridor','Station','Shoreline','Tower','Threshold','Chamber','Crossing','Ruin','Broadcast','Carrier','Tape','Tone','Frequency','Static','Echo','Planet','Crater','Signal','Void','Debris','Orbit','Dust','Transmission','Horizon','Remnant']
};

let selectedMood    = null;
let selectedSetting = null;
let history = [];
let lastConcept = '';

function toggle(btn) {
  const group = btn.dataset.group;
  const val   = btn.dataset.val;

  // Deselect others in same group
  document.querySelectorAll(`.selector-btn[data-group="${group}"]`).forEach(b => b.classList.remove('active'));

  if (group === 'mood') {
    if (selectedMood === val) { selectedMood = null; }
    else { selectedMood = val; btn.classList.add('active'); }
  } else {
    if (selectedSetting === val) { selectedSetting = null; }
    else { selectedSetting = val; btn.classList.add('active'); }
  }
}

function pick(arr, exclude) {
  const pool = exclude ? arr.filter(x => x !== exclude) : [...arr];
  return pool[Math.floor(Math.random() * pool.length)];
}

function buildPool(source, keys) {
  // Merge pools from relevant keys, deduplicate
  const combined = [];
  keys.forEach(k => { if (source[k]) source[k].forEach(w => { if (!combined.includes(w)) combined.push(w); }); });
  return combined;
}

function generate() {
  const moodKey    = selectedMood    || null;
  const settingKey = selectedSetting || null;

  // Build modifier pool
  const modKeys = ['neutral'];
  if (moodKey)    modKeys.push(moodKey);
  if (settingKey) modKeys.push(settingKey);
  const modPool = buildPool(modifiers, modKeys);

  // Build noun pool
  const nounKeys = ['neutral'];
  if (moodKey)    nounKeys.push(moodKey);
  if (settingKey) nounKeys.push(settingKey);

  // Weight setting nouns more heavily when a setting is chosen
  let nounPool;
  if (settingKey) {
    // 60% chance to draw noun from setting pool, 40% from full pool
    nounPool = [...nouns[settingKey], ...nouns[settingKey], ...buildPool(nouns, nounKeys)];
  } else if (moodKey) {
    nounPool = [...nouns[moodKey], ...nouns[moodKey], ...nouns.neutral];
  } else {
    nounPool = nouns.neutral;
  }

  const modifier = pick(modPool, history[0]?.modifier);
  const noun1    = pick(nounPool, history[0]?.noun1);

  const useThree = Math.random() < 0.35;
  let noun2 = null;
  if (useThree) {
    noun2 = pick(nounPool.filter(n => n !== noun1), history[0]?.noun2);
  }

  const concept = useThree ? `${modifier} ${noun1} ${noun2}` : `${modifier} ${noun1}`;
  if (concept === lastConcept) { generate(); return; }
  lastConcept = concept;

  history.unshift({ text: concept, modifier, noun1, noun2 });
  if (history.length > 10) history.pop();

  showConcept(concept);
  renderHistory();
}

function showConcept(concept) {
  const textEl  = document.getElementById('concept-text');
  const emptyEl = document.getElementById('empty');

  textEl.classList.remove('visible');

  setTimeout(() => {
    emptyEl.style.display = 'none';
    textEl.style.display  = 'block';
    textEl.textContent    = concept;
    requestAnimationFrame(() => textEl.classList.add('visible'));
  }, 150);
}

function renderHistory() {
  const wrap  = document.getElementById('history');
  const items = document.getElementById('history-items');
  if (history.length <= 1) { wrap.style.display = 'none'; return; }
  wrap.style.display = 'block';
  items.innerHTML = history.slice(1).map((h, i) =>
    `<span class="history-chip" onclick="recallHistory(${i+1})">${h.text}</span>
     <span class="history-sep">·</span>`
  ).join('');
}

function recallHistory(i) {
  showConcept(history[i].text);
}

window.addEventListener('load', () => setTimeout(generate, 300));
</script>
</body>
</html>
