<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ambient Concept Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Cutive+Mono&family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:        #080807;
    --border:    #2a2a26;
    --border-mid:#606050;
    --dim:       #a0a088;
    --mid:       #c8c8a8;
    --text:      #deded8;
    --bright:    #f0f0e0;
    --line:      #3a3a30;

    --light-text:   #d0ddb0;
    --light-label:  #a0c080;
    --light-lock:   #90b070;

    --dark-text:    #c0b0a0;
    --dark-label:   #b0a090;
    --dark-lock:    #a09080;

    --noun-text:    #d4c490;
    --noun-label:   #b0a080;

    --set-space:      #9a8abb;
    --set-nature:     #8abb9a;
    --set-city:       #8aabbb;
    --set-industrial: #bbae8a;
    --set-archive:    #abbb8a;
    --set-fantasy:    #bb9a8a;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Cutive Mono', monospace;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 48px 24px 80px;
  }

  body::after {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    opacity: 0.022;
    pointer-events: none;
    z-index: 999;
  }

  .wrap {
    width: 100%;
    max-width: 600px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .eyebrow {
    font-size: 11px;
    letter-spacing: 4px;
    color: var(--dim);
    text-transform: uppercase;
    margin-bottom: 56px;
    align-self: flex-start;
  }

  /* â”€â”€ DIAGRAM â”€â”€ */
  .diagram {
    width: 100%;
    position: relative;
    margin-bottom: 52px;
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.5s ease, transform 0.5s ease;
  }

  .diagram.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* SVG lines layer â€” sits behind the words */
  .lines-svg {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: visible;
  }

  .lines-svg line {
    stroke: var(--line);
    stroke-width: 1;
  }

  /* Three rows: light, noun, dark */
  .row {
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    padding: 12px 0;
  }

  .row-light  { justify-content: flex-start; padding-left: 0; }
  .row-noun   { justify-content: flex-end; padding: 20px 0; }
  .row-dark   { justify-content: flex-start; padding-left: 0; }

  /* Word + lock grouped */
  .word-group {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .word-label {
    font-size: 11px;
    letter-spacing: 4px;
    text-transform: uppercase;
    margin-bottom: 4px;
  }

  .light-group .word-label { color: var(--light-label); }
  .noun-group  .word-label { color: var(--noun-label); text-align: center; }
  .dark-group  .word-label { color: var(--dark-label); }

  .word-text {
    font-family: 'Cormorant Garamond', serif;
    font-weight: 300;
    line-height: 1;
    transition: opacity 0.3s ease;
  }

  .light-group .word-text {
    font-style: italic;
    font-size: clamp(30px, 7vw, 48px);
    color: var(--light-text);
    letter-spacing: -0.5px;
  }

  .noun-group .word-text {
    font-style: normal;
    font-size: clamp(36px, 9vw, 60px);
    color: var(--noun-text);
    letter-spacing: 3px;
    text-transform: uppercase;
    font-weight: 400;
    text-align: right;
  }

  .dark-group .word-text {
    font-style: normal;
    font-size: clamp(30px, 7vw, 48px);
    color: var(--dark-text);
    letter-spacing: 2px;
  }

  /* Lock button */
  .lock-btn {
    background: transparent;
    border: none;
    font-size: 16px;
    cursor: pointer;
    opacity: 0.45;
    transition: opacity 0.15s ease;
    padding: 4px;
    line-height: 1;
    flex-shrink: 0;
  }

  .lock-btn:hover  { opacity: 0.8; }
  .lock-btn.locked { opacity: 1; }

  /* â”€â”€ SETTINGS â”€â”€ */
  .settings-wrap {
    width: 100%;
    margin-bottom: 32px;
  }

  .control-row {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    justify-content: center;
  }

  .row-label {
    font-size: 11px;
    letter-spacing: 3px;
    color: var(--dim);
    text-transform: uppercase;
    width: auto;
    white-space: nowrap;
    text-align: right;
    flex-shrink: 0;
    padding-right: 8px;
  }

  .selector-btn {
    background: transparent;
    border: 1px solid var(--border-mid);
    color: var(--mid);
    font-family: 'Cutive Mono', monospace;
    font-size: 12px;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 8px 16px;
    cursor: pointer;
    transition: all 0.12s ease;
  }

  .selector-btn:hover { color: var(--text); border-color: var(--text); }

  .selector-btn.active[data-val="space"]      { border-color: var(--set-space);      color: var(--set-space); }
  .selector-btn.active[data-val="nature"]     { border-color: var(--set-nature);     color: var(--set-nature); }
  .selector-btn.active[data-val="city"]       { border-color: var(--set-city);       color: var(--set-city); }
  .selector-btn.active[data-val="industrial"] { border-color: var(--set-industrial); color: var(--set-industrial); }
  .selector-btn.active[data-val="archive"]    { border-color: var(--set-archive);    color: var(--set-archive); }
  .selector-btn.active[data-val="fantasy"]    { border-color: var(--set-fantasy);    color: var(--set-fantasy); }

  /* Generate */
  .generate-btn {
    background: transparent;
    border: 1px solid var(--border-mid);
    color: var(--mid);
    font-family: 'Cutive Mono', monospace;
    font-size: 13px;
    letter-spacing: 5px;
    text-transform: uppercase;
    padding: 14px 44px;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-bottom: 16px;
  }

  .generate-btn:hover { border-color: var(--bright); color: var(--bright); }
  .generate-btn:active { transform: scale(0.97); }

  .lock-hint {
    font-size: 11px;
    color: var(--dim);
    letter-spacing: 1px;
    margin-bottom: 52px;
    text-align: center;
  }

  /* History */
  .history {
    width: 100%;
    border-top: 1px solid var(--border);
    padding-top: 24px;
    display: none;
  }

  .history-label {
    font-size: 11px;
    letter-spacing: 4px;
    color: var(--dim);
    text-transform: uppercase;
    margin-bottom: 14px;
    text-align: center;
  }

  .history-items {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    justify-content: center;
    align-items: center;
  }

  .history-chip {
    font-family: 'Cormorant Garamond', serif;
    font-style: italic;
    font-size: 16px;
    color: var(--mid);
    cursor: pointer;
    transition: color 0.12s;
    padding: 2px 6px;
  }

  .history-chip:hover { color: var(--text); }
  .history-sep { color: var(--dim); font-size: 12px; }
</style>
</head>
<body>
<div class="wrap">

  <div class="eyebrow">Soap Box Rocket // Concept Engine</div>

  <!-- Diagram -->
  <div class="diagram" id="diagram">

    <svg class="lines-svg" id="lines-svg"><line id="line-light"/><line id="line-dark"/></svg>

    <div class="row row-light" id="row-light">
      <div class="word-group light-group" id="group-light">
        <button class="lock-btn" id="lock-light-mod" onclick="toggleLock('light-mod')" title="Lock">ðŸ”“</button>
        <div>
          <div class="word-label">Light</div>
          <div class="word-text" id="word-light"></div>
        </div>
      </div>
    </div>

    <div class="row row-noun" id="row-noun">
      <div class="word-group noun-group" id="group-noun">
        <button class="lock-btn" style="visibility:hidden">ðŸ”“</button>
        <div>
          <div class="word-text" id="word-noun"></div>
        </div>
        <button class="lock-btn" id="lock-noun" onclick="toggleLock('noun')" title="Lock">ðŸ”“</button>
      </div>
    </div>

    <div class="row row-dark" id="row-dark">
      <div class="word-group dark-group" id="group-dark">
        <button class="lock-btn" id="lock-dark-mod" onclick="toggleLock('dark-mod')" title="Lock">ðŸ”“</button>
        <div>
          <div class="word-text" id="word-dark"></div>
          <div class="word-label">Dark</div>
        </div>
      </div>
    </div>

  </div>

  <!-- Settings -->
  <div class="settings-wrap">
    <div class="control-row">
      <div class="row-label">Setting</div>
      <button class="selector-btn" data-group="setting" data-val="space"      onclick="toggleSetting(this)">Space</button>
      <button class="selector-btn" data-group="setting" data-val="nature"     onclick="toggleSetting(this)">Nature</button>
      <button class="selector-btn" data-group="setting" data-val="city"       onclick="toggleSetting(this)">City</button>
      <button class="selector-btn" data-group="setting" data-val="industrial" onclick="toggleSetting(this)">Industrial</button>
      <button class="selector-btn" data-group="setting" data-val="archive"    onclick="toggleSetting(this)">Archive</button>
      <button class="selector-btn" data-group="setting" data-val="fantasy"    onclick="toggleSetting(this)">Fantasy</button>
    </div>
  </div>

  <button class="generate-btn" onclick="generate()">Generate</button>
  <div class="lock-hint">ðŸ”“ tap a lock to hold a word â€” changing setting unlocks all</div>

  <div class="history" id="history">
    <div class="history-label">// Previous</div>
    <div class="history-items" id="history-items"></div>
  </div>

</div>

<script>
const modifiers = {
  dark:       ['Hollow','Buried','Fractured','Broken','Decaying','Frozen','Silent','Last','Forgotten','Collapsed','Irradiated','Redacted','Locked','Threatening','Incomplete'],
  light:      ['Drifting','Distant','Borrowed','Slow','Pale','Overgrown','Flooded','Weathered','Lost','Soft','Open','Fading'],
  space:      ['Collapsed','Irradiated','Ancient','Uncharted','Orbital','Expelled'],
  nature:     ['Overgrown','Flooded','Weathered','Rooted','Submerged','Seasonal'],
  city:       ['Compressed','Interrupted','Degraded','Looping','Wired','Overnight'],
  industrial: ['Corroded','Pressurized','Grinding','Dormant','Decommissioned','Leaking'],
  archive:    ['Classified','Encrypted','Redacted','Deteriorating','Preserved','Incomplete'],
  fantasy:    ['Unnamed','Lost','Forgotten','Buried','Uncharted','Cursed'],
  neutral:    ['Lonely','Frozen','Decaying','Distant','Hollow','Buried','Drifting','Silent','Fractured','Borrowed','Forgotten','Slow','Pale','Broken','Last']
};

const nouns = {
  space:      ['Planet','Crater','Void','Debris','Orbit','Dust','Transmission','Horizon','Remnant','Signal'],
  nature:     ['Shoreline','Crossing','Current','Bloom','Canopy','Estuary','Ridge','Hollow','Sediment','Shore'],
  city:       ['Corridor','Station','Archive','Broadcast','Frequency','Pulse','Tower','Overpass','Terminal','Grid'],
  industrial: ['Turbine','Pipeline','Compressor','Furnace','Silo','Substation','Foundry','Valve','Chamber','Generator'],
  archive:    ['Dispatch','Chronicle','Relic','Operator','Tape','Record','Cipher','Dossier','Transmission','Broadcast'],
  fantasy:    ['Cartographer','Cipher','Keeper','Dispatch','Expedition','Relic','Passage','Chronicle','Operator','Witness'],
  neutral:    ['Ferry','Archive','Corridor','Station','Shoreline','Tower','Threshold','Chamber','Crossing','Ruin','Tape','Frequency','Static','Echo','Planet','Crater','Signal','Void','Debris','Orbit','Dust','Transmission','Horizon','Remnant']
};

let state   = { lightMod: '', noun: '', darkMod: '' };
let locked  = { 'light-mod': false, 'noun': false, 'dark-mod': false };
let selectedSetting = null;
let history = [];

function pick(arr, exclude) {
  const pool = exclude ? arr.filter(x => x !== exclude) : [...arr];
  if (!pool.length) return arr[Math.floor(Math.random() * arr.length)];
  return pool[Math.floor(Math.random() * pool.length)];
}

function buildPool(source, keys) {
  const out = [];
  keys.forEach(k => { if (source[k]) source[k].forEach(w => { if (!out.includes(w)) out.push(w); }); });
  return out;
}

function getModPool(mood) {
  const keys = [mood, 'neutral'];
  if (selectedSetting) keys.push(selectedSetting);
  return buildPool(modifiers, keys);
}

function getNounPool() {
  if (selectedSetting) return [...nouns[selectedSetting], ...nouns[selectedSetting], ...nouns.neutral];
  return nouns.neutral;
}

function generate() {
  if (!locked['light-mod']) state.lightMod = pick(getModPool('light'), state.lightMod);
  if (!locked['noun'])      state.noun     = pick(getNounPool(), state.noun);
  if (!locked['dark-mod'])  state.darkMod  = pick(getModPool('dark'), state.darkMod);
  if (state.darkMod === state.lightMod) state.darkMod = pick(getModPool('dark').filter(w => w !== state.lightMod));

  history.unshift({ ...state });
  if (history.length > 10) history.pop();

  render();
  renderHistory();
}

function toggleLock(key) {
  locked[key] = !locked[key];
  const btn = document.getElementById(`lock-${key}`);
  btn.textContent = locked[key] ? 'ðŸ”’' : 'ðŸ”“';
  btn.classList.toggle('locked', locked[key]);
}

function toggleSetting(btn) {
  const val = btn.dataset.val;
  document.querySelectorAll('.selector-btn').forEach(b => b.classList.remove('active'));
  selectedSetting = (selectedSetting === val) ? null : val;
  if (selectedSetting) btn.classList.add('active');
  // Unlock all
  Object.keys(locked).forEach(k => {
    locked[k] = false;
    const lb = document.getElementById(`lock-${k}`);
    if (lb) { lb.textContent = 'ðŸ”“'; lb.classList.remove('locked'); }
  });
}

function render() {
  document.getElementById('word-light').textContent = state.lightMod;
  document.getElementById('word-noun').textContent  = state.noun;
  document.getElementById('word-dark').textContent  = state.darkMod;

  const diagram = document.getElementById('diagram');
  if (!diagram.classList.contains('visible')) diagram.classList.add('visible');

  // Draw lines after layout settles
  requestAnimationFrame(() => requestAnimationFrame(drawLines));
}

function drawLines() {
  const svg       = document.getElementById('lines-svg');
  const diagRect  = document.getElementById('diagram').getBoundingClientRect();

  const lightEl   = document.getElementById('word-light');
  const nounEl    = document.getElementById('word-noun');
  const darkEl    = document.getElementById('word-dark');

  function center(el) {
    const r = el.getBoundingClientRect();
    return {
      x: r.left + r.width  / 2 - diagRect.left,
      y: r.top  + r.height / 2 - diagRect.top
    };
  }

  const lc = center(lightEl);
  const nc = center(nounEl);
  const dc = center(darkEl);

  const lineLight = document.getElementById('line-light');
  lineLight.setAttribute('x1', lc.x); lineLight.setAttribute('y1', lc.y);
  lineLight.setAttribute('x2', nc.x); lineLight.setAttribute('y2', nc.y);

  const lineDark = document.getElementById('line-dark');
  lineDark.setAttribute('x1', dc.x); lineDark.setAttribute('y1', dc.y);
  lineDark.setAttribute('x2', nc.x); lineDark.setAttribute('y2', nc.y);
}

function renderHistory() {
  const wrap  = document.getElementById('history');
  const items = document.getElementById('history-items');
  if (history.length <= 1) { wrap.style.display = 'none'; return; }
  wrap.style.display = 'block';
  items.innerHTML = history.slice(1).map((h, i) =>
    `<span class="history-chip" onclick="recallHistory(${i+1})">${h.lightMod} Â· ${h.noun} Â· ${h.darkMod}</span>
     <span class="history-sep">â€”</span>`
  ).join('');
}

function recallHistory(i) {
  state = { ...history[i] };
  render();
}

window.addEventListener('load',   () => setTimeout(generate, 300));
window.addEventListener('resize', drawLines);
</script>
</body>
</html>
